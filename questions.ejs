<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- quill -->
        <link
            href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css"
            rel="stylesheet" />
        <!-- quill -->
        <title></title>
        <script
            src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js">
        </script>
        <script>
            let A=[];
        </script>
    </head>
    <body>
        <form action="/ejs" method="post">
            <label for="name">Фамилия</label><input type="text" name="name"/>
            <label for="ticket">Билет №</label><input type="text" name="ticket"/>
            <% let question=0;
                Q.forEach( (el) => {%>
                    <p><b>Вопрос <%= question+1 %></b>: <%=Q[question]%></p>
                    <div id="A<%=question%>"></div>
                    <script>
                        // const qel<%=question%>=
                        A.push(new Quill('#A<%=question%>', {
                            theme: 'snow',
                        }));
                    </script>
            <%question++; })%>
            <input type="submit"/>
        </form>
        <!-- quill -->

        <script>
            const form = document.querySelector('form');
            let i=0;
        
        form.addEventListener('formdata', (event) => {
           <% let iq=0; Q.forEach((el)=>{ %>
            event.formData.append('A', JSON.stringify(A[<%=iq%>].getContents().ops));
            <% iq++;    }); %>
        });


            // Q.forEach( (el) => {
            //     alert(JSON.stringify(A[i].getContents().ops));
            //     // form.addEventListener('formdata', (event) => {
            //     //     event.formData.append('A1', JSON.stringify(quill1.getContents().ops));
            // //         event.formData.append('A2', JSON.stringify(quill2.getContents().ops));
            //     // });
            //     i++;
            // });
        </script>
        <!-- quill -->
    </body>
</html>